txn Fee
int TMPL_FEE
<
txn TypeEnum
int 1 // Payment
==
&&
txn Receiver
global ZeroAddress
==
&&
txn Amount
int 0
==
&& // ok Fee and is Payment and no Receiver and 0 Amount

txn CloseRemainderTo
addr TMPL_RCV
==
arg_0
TMPL_HASHFN
byte base64 TMPL_HASHIMG
==
&& // CloseRemainderTo is recipient and secret was provided

txn CloseRemainderTo
addr TMPL_OWN
==
txn FirstValid
int TMPL_TIMEOUT
>
&& // CloseRemainderTo is originator and timeout happened

|| // (recipient and secret) or (originator and timeout)

&& // and (Fee/Payment/Receiver/Amount) checks from the top
